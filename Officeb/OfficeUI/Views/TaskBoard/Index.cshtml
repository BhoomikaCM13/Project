@model OfficeEntity.TaskBoard;

@{
    Layout = "~/Views/Shared/_Layout1.cshtml";
}
<!-- Topbar -->
@*<nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between m-4">
        <h1 class="h3 mb-0 text-primary"><strong>Task Details</strong></h1>
    </div>
</nav>*@

<nav>
    <div class="header text-uppercase" style="color:White ; text-decoration-style:solid">
        <h1>TASK DETAILS</h1>
    </div>
</nav>
<!-- End of Topbar -->
<!-- Begin Page Content -->
<div class="container-fluid">
    <!-- Content Row -->
    <div class="row">
        <div class="card col-xxl-12 col-xl-12 col-lg-12  border-primary">
              <div class="card-header">
                    <p class="text-lg" style="display: inline;"><strong>@Model._task.Title</strong></p>
                    <!-- Circle Buttons (Small) -->
                    <div *ngIf="currentUser?.id == task?.userId" style="display: inline;">
                        <a asp-controller="Task" asp-action="EditTasks" asp-route-Id="@Model._task.Id"><i class="fa-solid fa-pen-to-square" style="color:seagreen"></i></a>
                        <a asp-controller="Task" asp-action="DeleteTasks" asp-route-Id="@Model._task.Id"><i class="fa-solid fa-trash" style="color:red"></i></a>
                    </div>
                </div>
                <div class="card-body">
                    <p class="text-lg" style="display: inline;"><strong>@Model._task.Description</strong></p>
                    <hr>
                    <p>
                        <small class="text-muted">
                            Status:
                            <strong>@Model._task.Status</strong>
                        </small>
                    </p>
                    <p>
                        <small class="text-muted">
                            Created On:
                            <strong>@Model._task.CreatedOn</strong>
                        </small> |
                        <small class="text-muted">
                            Created By:
                            <a routerLink="/profile/user/{{task?.userId}}"><strong>@Model._task.profile.Name</strong></a>
                        </small> <br>
                        <small class="text-muted">Comments: <strong>@Model.countMessage</strong></small>
                        <br /> 
                        Add Comments:
                    <button type="button" class="btn" data-toggle="modal" data-target="#exampleModal" >
                        <i class="fa-solid fa-circle-plus" style="color:mediumslateblue" title="Add Comments"></i>
                    </button>
                    </p>
                </div>
            </div>
    </div>
</div>
@*<div class="row mb-4">
    <div class="col-lg-3"></div>
    <div class="col-lg-8">
        <!-- Open Modal -->
        @*<button style="Background-color:forestgreen">
        <i class="fa-solid fa-plus" style="color:black;"></i>
        <a asp-controller="Comment" asp-action="CreateComment"><span style="color:black ;">Add Comment</span> </a>
        </button>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
            Add Comment
        </button>
    </div>
</div>*@

<!-- COMMENTS BY TASK -->
<!-- Begin Page Content -->
<hr />

<div class="container-fluid comments" >
    <!-- Content Row -->
    <div class="col-lg-3 text-center">
        <h1 class="h3 " style="color:mediumpurple"><strong>Comments:</strong></h1>
    </div>
    <div class="row">

       @* <div class="col-lg-3 text-center">
        <h1 class="h3 text-primary"><strong>Comments:</strong></h1>
        </div>*@
        @foreach (var item in Model.comments)
        {
            <!-- Border Left Utilities -->
            <div class="col-lg-8">
                <div *ngFor="let comment of comments|slice:0:show">
                    <div class="card mb-4 py-3 border-left-primary">
                        <div class="card-body">
                            <p>@item.Content</p>
                            <p>
                                <small class="text-muted">
                                    Author:
                                    <a routerLink="/profile/user/{{comment.userId}}"><strong>@item.Profile.Name</strong></a>
                                </small> |
                                <small class="text-muted">
                                    Created On:
                                    <strong>@item.CreatedOn</strong>
                                </small>
                                @* <small class="text-muted">
                            id
                            <strong>@item.Id</strong>
                            </small>
                            <small class="text-muted">
                            tid
                            <strong>@item.taskId</strong>
                            </small>*@
                            </p>
                            <!-- Circle Buttons (Small) -->
                            <a asp-controller="Comment" asp-action="EditComment" asp-route-Id="@item.Id"><i class="fa-solid fa-pen-to-square" style="color:seagreen"></i></a>
                            <a asp-controller="Comment" onclick="Myfunction()" asp-action="DeleteComment" asp-route-commentid="@item.Id"><i class="fa-solid fa-trash" style="color:red"></i></a>
                        </div>
                    </div>
                </div>
                @* <div class="mb-4">
            <a *ngIf="show<comments.length" (click)="show = show + 3" class="btn btn-primary btn-icon-split">
            <span class="icon text-white-50">
            <fa-icon [icon]="faArrowDown"></fa-icon>
            </span>
            @* <span class="text" style="color: white;">Load More</span>
            </a>
            </div>*@

            </div>
        }

        @*<div class="mb-4 ml-4">
            <form method="post">
                <a>
                    <input type="submit" value="load more" />
                </a>
            </form>
        </div>*@
        
        

    </div>
    
</div>
<div class="mb-4 ml-4">
    <form method="post">
        <a>
            <a asp-controller="TaskBoard" asp-action="Index1" class="btn btn-danger">Load</a>
        </a>
    </form>
</div>



    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">
                        Comments

                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" >
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <label>Content</label>
                            <textarea class="form-control" asp-for="_comment" rows="8" placeholder="Enter Content"></textarea>
                        </div>



                        @*   <div class="form-group">
                        <input hidden type="number" class="form-control" formControlName="TaskId">
                        </div>*@
                        <div class="row">
                            <div class="col-6">
                                <input type="submit" value="Create" onclick="Myfunction2()" class="btn btn-success btn-user btn-block my-4" />
                            </div>
                            <div class="col-6">
                                <input type="reset" value="Cancel" class="btn btn-outline-danger btn-user btn-block my-4" />
                            </div>
                        </div>
                        @if (ViewBag.status == "Ok")
                        {
                            <div class="alert alert-success">
                                @ViewBag.message
                            </div>
                        }
                        else if (ViewBag.status == "Error")
                        {
                            <div class="alert alert-danger">
                                @ViewBag.message
                            </div>
                        }
                    </form>
                </div>
            </div>
        </div>
    </div>
@*
<div class="mb-4 ml-4">
     <form method="get">
    <a>
        <a asp-controller="Message" asp-action="Index1" class="btn btn-danger">Load</a>
    </a>
     </form>
</div>*@
<script>
    function Myfunction() {
        let val = confirm("Do you want to delete the comment?");
        if (val == false) {
            return event.preventDefault();
        }
    }
    function Myfunction2(){
        alert("Commnet added successfully!!");
    }
</script>